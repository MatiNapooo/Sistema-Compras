{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="{% static 'css/menu.css' %}?v=2">
    <title>Sistema Compras</title>
    <script>
        // Check dark mode immediately to prevent flash
        if (localStorage.getItem('darkMode') === 'enabled') {
            document.documentElement.classList.add('dark'); // Apply to html or body
            // We can't access body safely in head, so we often use documentElement or wait for body
            // However, class 'dark' is on body in CSS.
            // Best practice: add to documentElement (html tag) and update CSS to support both, 
            // OR use a blocking script in body.
            // Given the CSS uses body.dark, we should try to add it to body as soon as possible.
            // Let's add an early script right after body open if possible, or use DOMContentLoaded for the switch but apply class here if we can target html?
            // Checking CSS: body.dark { ... }
            // Let's update CSS to support html.dark as well OR just wait for body.
            // Actually, simplest is to put this script right inside <body> start.
        }
    </script>
</head>

<body>

    <section id="sidebar">
        <a href="#" class="brand" id="brand-link">
            <img src="{% static 'img/logo_nextprint.jpeg' %}" alt="Logo NP" class="brand-logo">

            <span class="text">Nextprint</span>
        </a>
        <ul class="side-menu top">
            <li class="{% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">
                <a href="{% url 'dashboard' %}">
                    <i class='bx bxs-dashboard bx-sm'></i>
                    <span class="text">Inicio</span>
                </a>
            </li>
            <li
                class="{% if request.resolver_match.url_name == 'nueva_compra' or request.resolver_match.url_name == 'compra_insumo' %}active{% endif %}">
                <a href="{% url 'nueva_compra' %}">
                    <i class='bx bxs-shopping-bag-alt bx-sm'></i>
                    <span class="text">Nueva Compra</span>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class='bx bxs-doughnut-chart bx-sm'></i>
                    <span class="text">Ordenes</span>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class='bx bxs-message-dots bx-sm'></i>
                    <span class="text">Historial</span>
                </a>
            </li>
        </ul>
        <ul class="side-menu bottom">
            <li>
                <a href="{% url 'logout' %}" class="logout">
                    <i class='bx bx-power-off bx-sm bx-burst-hover'></i>
                    <span class="text">Salir</span>
                </a>
            </li>
        </ul>
    </section>

    <section id="content">
        <nav>
            <i class='bx bx-menu bx-sm'></i>

            <form action="#">
                <div class="form-input">
                    <input type="search" placeholder="Buscar...">
                    <button type="submit" class="search-btn"><i class='bx bx-search'></i></button>
                </div>
            </form>
            <input type="checkbox" class="checkbox" id="switch-mode" hidden />
            <label class="swith-lm" for="switch-mode">
                <i class="bx bxs-moon"></i>
                <i class="bx bx-sun"></i>
                <div class="ball"></div>
            </label>
            <a href="#" class="profile">
                <span style="margin-right: 10px; font-weight: 600; color: var(--dark);">{{ user.first_name }}</span>
                <img src="{{ user.profile.image.url }}" alt="Profile">
            </a>
        </nav>

        <main>
            {% block content %}
            {% endblock %}
        </main>
    </section>

    <script src="{% static 'js/menu.js' %}?v=2"></script>
</body>

</html>